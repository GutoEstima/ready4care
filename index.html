<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartCart - Gerenciamento de Carrinhos de Emergência</title>
    <!-- Link para o Tailwind CSS para estilização rápida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Novas fontes: Poppins (primária) e Inter (fallback) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="flex flex-col min-h-screen">

    <!-- Tela de Login -->
    <div id="login-screen" class="flex items-center justify-center min-h-screen bg-blue-100">
        <div id="login-card" class="card-login p-8 w-full max-w-md text-center">
            <!-- Logo na tela de login -->
            <img src="Logo.png" width="100%" height="100%" alt="SmartCart Logo">
            <p class="text-lg text-text-secondary mb-8" color="white">Gerenciamento Inteligente de Carrinhos de Emergência</p>
            <form id="login-form">
                <input type="email" placeholder="Usuário" value="jose.silva@smartcart.com" class="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                <input type="password" placeholder="Senha" value="senha123" class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                <button type="submit" class="w-full btn-primary">Entrar</button>
            </form>
        </div>
    </div>

    <!-- Conteúdo Principal da Aplicação (Escondido inicialmente) -->
    <div id="main-app" class="flex-1 hidden">
        <!-- Barra de Tarefas (Navbar) -->
        <nav class="header-bg p-4 shadow-md flex justify-between items-center">
            <div class="flex items-center">
                <!-- Ícone do sanduíche para abrir a barra lateral -->
                <button class="openbtn mr-4" onclick="openNav()">&#9776;</button>
                <!-- Logo na barra de navegação -->
                <img src="Logo 2.png" alt="SmartCart Logo" height="auto" width="20%" onclick="showDashboard()">
            </div>
            <div class="flex items-center">
                    <button id="alerts-btn-icon" class="text-2xl mr-4">
                    <i class="fas fa-bell"></i>
                </button>
                <!-- Ícone de pessoa para configurações do perfil/conta -->
                <button id="profile-settings-btn-icon" class="text-2xl">
                    <i class="fas fa-user-circle"></i>
                </button>
            </div>
        </nav>

        <!-- Barra Lateral Colapsável -->
        <div id="mySidebar" class="sidebar">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="#" id="sidebar-dashboard-btn" onclick="showDashboard(); closeNav();">Dashboard</a>
            <a href="#" id="sidebar-standard-form-btn" onclick="showStandardFormPage(); closeNav();">Formulário Padrão</a>
            <a href="#" id="sidebar-cart-status-btn" onclick="showPage('cart-status-page'); closeNav();">Status dos Carrinhos</a>
            <a href="#" id="sidebar-cart-settings-btn" onclick="showCartSettingsPage(); closeNav();">Configurações dos Carrinhos</a>
            <a href="#" id="sidebar-logout-btn" onclick="showLogoutConfirmation(); closeNav();">Sair</a>
        </div>

        <!-- Área de Conteúdo Principal -->
        <div id="main-content-area" class="flex-1 p-6">
            <!-- Dashboard Principal -->
            <div id="dashboard-page" class="page-content">
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Card de Carrinhos em Conformidade -->
                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow duration-300" onclick="showCartDetails('conformity')">
                        <h3 class="text-xl font-medium mb-2 text-text-secondary">Carrinhos em Conformidade</h3>
                        <p class="text-5xl font-bold text-success">4</p>
                    </div>
                    <!-- Card de Carrinhos com Itens Faltando -->
                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow duration-300" onclick="showCartDetails('missing')">
                        <h3 class="text-xl font-medium mb-2 text-text-secondary">Itens Faltando</h3>
                        <p class="text-5xl font-bold text-danger">2</p>
                    </div>
                    <!-- Card de Carrinhos com Itens Vencidos -->
                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow duration-300" onclick="showCartDetails('expired')">
                        <h3 class="text-xl font-medium mb-2 text-text-secondary">Itens Vencidos</h3>
                        <p class="text-5xl font-bold text-danger">1</p>
                    </div>
                    <!-- Card de Carrinhos com Itens a Vencer -->
                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow duration-300" onclick="showCartDetails('expiring')">
                        <h3 class="text-xl font-medium mb-2 text-text-secondary">Itens a Vencer</h3>
                        <p class="text-5xl font-bold text-warning">3</p>
                    </div>
                </div>

                <!-- Nova Seção: Atividade Recente/Log de Eventos -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="card p-6">
                        <h3 class="text-2xl font-semibold mb-4 text-text-primary">Atividade Recente</h3>
                        <ul class="space-y-3 text-text-secondary">
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-success mr-2"></i>
                                <span><strong class="text-text-primary">Carrinho 007</strong> - Verificado em Observação (11:00)</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-danger mr-2"></i>
                                <span><strong class="text-text-primary">Alerta:</strong> 'Dipirona' faltando no <strong class="text-text-primary">Carrinho 004</strong> (10:45)</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-calendar-times text-danger mr-2"></i>
                                <span><strong class="text-text-primary">Alerta:</strong> 'Morfina' vencida no <strong class="text-text-primary">Carrinho 008</strong> (10:30)</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-hourglass-half text-warning mr-2"></i>
                                <span><strong class="text-text-primary">Alerta:</strong> 'Soro Fisiológico' a vencer no <strong class="text-text-primary">Carrinho 001</strong> (10:15)</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Alertas Críticos e Ações Pendentes (no Dashboard) -->
                    <div class="card p-6">
                        <h3 class="text-2xl font-semibold mb-4 text-text-primary">Alertas Críticos e Ações Pendentes</h3>
                        <div id="dashboard-alerts-content">
                            <!-- Alerts will be populated here by JS -->
                        </div>
                    </div>
                </div>

                <!-- Nova Seção: Visão Geral do Inventário Total e Itens Próximos do Vencimento -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-2xl font-semibold mb-4 text-text-primary">Visão Geral do Inventário Total</h3>
                        <div class="space-y-3 text-text-secondary">
                            <p>Total de Medicações Registradas: <strong class="text-text-primary">2500 unidades</strong></p>
                            <p>Total de Materiais Registrados: <strong class="text-text-primary">1200 unidades</strong></p>
                            <p>Carrinhos Monitorados: <strong class="text-text-primary">10</strong></p>
                            <p>Média de Conformidade: <strong class="text-success">92%</strong></p>
                        </div>
                    </div>

                    <!-- Nova Seção: Itens Próximos do Vencimento (Destaque) -->
                    <div class="card p-6">
                        <h3 class="text-2xl font-semibold mb-4 text-text-primary">Itens Próximos do Vencimento</h3>
                        <ul class="space-y-3 text-text-secondary">
                            <li class="flex justify-between items-center">
                                <span><strong class="text-text-primary">Soro Fisiológico</strong> - Carrinho 001</span>
                                <span class="text-warning">Vence em: 15/09/2025</span>
                            </li>
                            <li class="flex justify-between items-center">
                                <span><strong class="text-text-primary">Vitamina K</strong> - Carrinho 010</span>
                                <span class="text-warning">Vence em: 25/08/2025</span>
                            </li>
                            <li class="flex justify-between items-center">
                                <span><strong class="text-text-primary">Cefalosporina</strong> - Carrinho 009</span>
                                <span class="text-warning">Vence em: 01/09/2025</span>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>

            <!-- Página de Detalhes do Carrinho (oculta por padrão) -->
            <div id="cart-details-page" class="page-content hidden">
                <button class="btn-primary mb-4" onclick="showDashboard()">Voltar ao Dashboard</button>
                <h2 id="cart-details-title" class="text-3xl font-semibold mb-6 text-text-primary">Detalhes do Carrinho</h2>
                <div id="cart-details-content" class="card p-6">
                    <!-- Conteúdo dinâmico será carregado aqui -->
                </div>
            </div>

            <!-- Página de Configurações do Perfil/Conta (oculta por padrão) -->
            <div id="profile-settings-page" class="page-content hidden">
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Configurações do Perfil/Conta</h2>
                <div class="card p-6">
                    <p class="text-text-secondary">Conteúdo das configurações do perfil e da conta.</p>
                    <form class="mt-4 space-y-4">
                        <div>
                            <label for="username" class="block text-text-secondary text-sm font-bold mb-2">Nome de Usuário:</label>
                            <input type="text" id="username" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" value="José Silva">
                        </div>
                        <div>
                            <label for="email" class="block text-text-secondary text-sm font-bold mb-2">Email:</label>
                            <input type="email" id="email" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" value="jose.silva@smartcart.com">
                        </div>
                        <div>
                            <label for="password" class="block text-text-secondary text-sm font-bold mb-2">Alterar Senha:</label>
                            <input type="password" id="password" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Nova Senha">
                        </div>
                        <button type="submit" class="btn-primary">Salvar Alterações</button>
                    </form>
                </div>
            </div>

            <!-- Página de Formulário Padrão (oculta por padrão) -->
            <div id="standard-form-page" class="page-content hidden">
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Formulário Padrão</h2>
                <div class="card p-6 mb-6">
                    <h3 class="text-2xl font-semibold mb-4 text-text-primary">Predefinições de Carrinhos</h3>
                    <ul id="predefined-forms-list" class="space-y-3 mb-6">
                        <!-- Predefined forms will be listed here -->
                    </ul>
                    <button class="btn-primary" onclick="showNewPredefinedFormModal()">Nova Predefinição</button>
                </div>

                <!-- Section to display and modify selected predefined form -->
                <div id="selected-predefined-form-details" class="card p-6 hidden">
                    <h3 id="selected-predefined-form-title" class="text-2xl font-semibold mb-4 text-text-primary"></h3>
                    <p class="text-text-secondary mb-4">Itens e quantidades padrão para esta predefinição:</p>
                    <ul id="predefined-items-list" class="space-y-2 mb-6">
                        <!-- Items of the selected predefined form will be listed here -->
                    </ul>
                    <button class="btn-primary" onclick="showAddItemToPredefinedFormModal()">Adicionar/Alterar Item</button>
                </div>
            </div>

            <!-- Página de Status dos Carrinhos (oculta por padrão) -->
            <div id="cart-status-page" class="page-content hidden">
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Status Geral dos Carrinhos</h2>
                <div class="card p-6">
                    <ul class="space-y-4" id="general-cart-status-list">
                        <!-- Dynamic content will be loaded here -->
                    </ul>
                </div>
            </div>

            <!-- Nova Página de Detalhes do Carrinho Individual (oculta por padrão) -->
            <div id="cart-individual-page" class="page-content hidden">
                <button class="btn-primary mb-4" onclick="showPage('cart-status-page')">Voltar ao Status dos Carrinhos</button>
                <h2 id="individual-cart-title" class="text-3xl font-semibold mb-6 text-text-primary">Detalhes do Carrinho</h2>
                <div id="individual-cart-content" class="card p-6">
                    <!-- Conteúdo dinâmico do carrinho individual será carregado aqui -->
                </div>

                <!-- Seção de Relatórios -->
                <div class="card p-6 mt-6">
                    <h3 class="text-2xl font-semibold mb-4 text-text-primary">Relatórios Gerados</h3>
                    <button class="btn-primary mb-4" id="generate-report-btn">Gerar Novo Relatório</button>
                    <div id="reports-list" class="space-y-3">
                        <!-- Relatórios gerados dinamicamente aqui -->
                    </div>
                </div>
            </div>

            <!-- Nova Página de Alertas Críticos (oculta por padrão) -->
            <div id="alerts-page" class="page-content hidden">
                <button class="btn-primary mb-4" onclick="showDashboard()">Voltar ao Dashboard</button>
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Alertas Críticos e Ações Pendentes</h2>
                <div id="alerts-page-content" class="card p-6">
                    <!-- Alerts will be populated here -->
                </div>
            </div>

            <!-- Nova Página de Configurações dos Carrinhos (oculta por padrão) -->
            <div id="cart-settings-page" class="page-content hidden">
                <h2 class="text-3xl font-semibold mb-6 text-text-primary">Configurações dos Carrinhos</h2>
                <div class="card p-6">
                    <h3 class="text-2xl font-semibold mb-4 text-text-primary">Carrinhos Conectados</h3>
                    <ul id="connected-carts-list" class="space-y-4 mb-6">
                        <!-- Lista de carrinhos conectados -->
                    </ul>
                    <button class="btn-primary" onclick="showConnectNewCartModal()">Conectar Novo Carrinho</button>
                </div>
            </div>

            <!-- Nova Página de Edição de Carrinho Individual (oculta por padrão) -->
            <div id="edit-cart-settings-page" class="page-content hidden">
                <button class="btn-primary mb-4" onclick="showCartSettingsPage()">Voltar às Configurações dos Carrinhos</button>
                <h2 id="edit-cart-settings-title" class="text-3xl font-semibold mb-6 text-text-primary">Editar Carrinho: [ID do Carrinho]</h2>
                <div class="card p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="edit-cart-sector" class="block text-text-secondary text-sm font-bold mb-2">Setor:</label>
                            <input type="text" id="edit-cart-sector" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline">
                        </div>
                        <div>
                            <label class="block text-text-secondary text-sm font-bold mb-2">Status:</label>
                            <span id="edit-cart-online-status" class="font-semibold"></span>
                        </div>
                        <div>
                            <label class="block text-text-secondary text-sm font-bold mb-2">Sinal:</label>
                            <span id="edit-cart-signal-strength" class="font-semibold"></span>
                        </div>
                        <div>
                            <label for="edit-cart-report-periodicity" class="block text-text-secondary text-sm font-bold mb-2">Periodicidade do Relatório:</label>
                            <select id="edit-cart-report-periodicity" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline">
                                <option value="daily">Diário</option>
                                <option value="weekly">Semanal</option>
                                <option value="monthly">Mensal</option>
                            </select>
                        </div>
                    </div>

                    <h3 class="text-2xl font-semibold mb-4 text-text-primary">Itens do Carrinho</h3>
                    <div class="flex items-center space-x-4 mb-4">
                        <label for="apply-predefined-form" class="block text-text-secondary text-sm font-bold">Aplicar Predefinição:</label>
                        <select id="apply-predefined-form" class="shadow appearance-none border rounded py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline flex-grow">
                            <option value="">Selecione uma predefinição</option>
                            <!-- Options will be populated by JS -->
                        </select>
                        <button class="btn-primary px-4 py-2 text-sm" onclick="applyPredefinedFormToCart()">Aplicar</button>
                    </div>

                    <ul id="edit-cart-items-list" class="space-y-2 mb-6">
                        <!-- Items of the current cart will be listed here -->
                    </ul>
                    <button class="btn-primary" onclick="showAddEditCartItemModal()">Adicionar/Alterar Item</button>
                    <button class="btn-primary bg-accent hover:bg-red-700 ml-2" onclick="confirmDeleteItemFromCart()">Excluir Item Selecionado</button>
                </div>
                <button class="btn-primary mt-6" onclick="saveCartSettings()">Salvar Alterações do Carrinho</button>
            </div>

        </div>
    </div>

    <!-- Modals -->
    <div id="message-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <h3 id="modal-title" class="text-2xl font-semibold mb-4 text-text-primary"></h3>
            <p id="modal-body" class="text-text-secondary mb-6"></p>
            <div class="flex justify-end space-x-4">
                <button id="modal-cancel-btn" class="btn-primary bg-gray-400 hover:bg-gray-500 hidden">Cancelar</button>
                <button id="modal-confirm-btn" class="btn-primary hidden">Confirmar</button>
                <button id="modal-ok-btn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <div id="add-item-predefined-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeAddItemPredefinedModal()">&times;</span>
            <h3 class="text-2xl font-semibold mb-4 text-text-primary">Adicionar/Alterar Item na Predefinição</h3>
            <form id="add-item-predefined-form" class="space-y-4">
                <div>
                    <label for="predefined-item-name" class="block text-text-secondary text-sm font-bold mb-2">Nome do Item:</label>
                    <input type="text" id="predefined-item-name" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: Soro Fisiológico" required>
                </div>
                <div>
                    <label for="predefined-item-quantity" class="block text-text-secondary text-sm font-bold mb-2">Quantidade Padrão:</label>
                    <input type="number" id="predefined-item-quantity" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: 10" required min="1">
                </div>
                <button type="submit" class="btn-primary">Salvar Item</button>
            </form>
        </div>
    </div>

    <div id="new-predefined-form-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeNewPredefinedFormModal()">&times;</span>
            <h3 class="text-2xl font-semibold mb-4 text-text-primary">Criar Nova Predefinição</h3>
            <form id="new-predefined-form-creation-form" class="space-y-4">
                <div>
                    <label for="new-predefined-form-name" class="block text-text-secondary text-sm font-bold mb-2">Nome da Predefinição:</label>
                    <input type="text" id="new-predefined-form-name" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: Carrinho de Anestesia" required>
                </div>
                <button type="submit" class="btn-primary">Criar Predefinição</button>
            </form>
        </div>
    </div>

    <!-- Modal para Conectar Novo Carrinho -->
    <div id="connect-new-cart-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeConnectNewCartModal()">&times;</span>
            <h3 class="text-2xl font-semibold mb-4 text-text-primary">Conectar Novo Carrinho</h3>
            <form id="new-cart-form" class="space-y-4">
                <div>
                    <label for="new-cart-id" class="block text-text-secondary text-sm font-bold mb-2">ID do Carrinho:</label>
                    <input type="text" id="new-cart-id" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: Carrinho 013" required>
                </div>
                <div>
                    <label for="new-cart-sector" class="block text-text-secondary text-sm font-bold mb-2">Setor:</label>
                    <input type="text" id="new-cart-sector" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: Cardiologia" required>
                </div>
                <button type="submit" class="btn-primary">Conectar</button>
            </form>
        </div>
    </div>

    <!-- Modal para Adicionar/Alterar Item em Carrinho Específico -->
    <div id="add-edit-cart-item-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeAddEditCartItemModal()">&times;</span>
            <h3 class="text-2xl font-semibold mb-4 text-text-primary">Adicionar/Alterar Item no Carrinho</h3>
            <form id="add-edit-cart-item-form" class="space-y-4">
                <div>
                    <label for="cart-item-name" class="block text-text-secondary text-sm font-bold mb-2">Nome do Item:</label>
                    <input type="text" id="cart-item-name" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: Soro Fisiológico" required>
                </div>
                <div>
                    <label for="cart-item-standard-quantity" class="block text-text-secondary text-sm font-bold mb-2">Quantidade Padrão:</label>
                    <input type="number" id="cart-item-standard-quantity" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: 10" required min="1">
                </div>
                <div>
                    <label for="cart-item-current-quantity" class="block text-text-secondary text-sm font-bold mb-2">Quantidade Atual:</label>
                    <input type="number" id="cart-item-current-quantity" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" placeholder="Ex: 8" required min="0">
                </div>
                <div>
                    <label for="cart-item-validity" class="block text-text-secondary text-sm font-bold mb-2">Validade:</label>
                    <input type="date" id="cart-item-validity" class="shadow appearance-none border rounded w-full py-2 px-3 text-text-primary leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <button type="submit" class="btn-primary">Salvar Item no Carrinho</button>
            </form>
        </div>
    </div>


    <script src="app.js"></script>
</body>
</html>
